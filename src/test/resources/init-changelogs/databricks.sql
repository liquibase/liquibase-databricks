--liquibase formatted sql
--changeset liquibase:1 runAlways:true


CREATE DATABASE IF NOT EXISTS main.liquibase_harness_test_ds;

DROP TABLE IF EXISTS main.liquibase_harness_test_ds.authors;

CREATE TABLE main.liquibase_harness_test_ds.authors (
                           `id` BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY(start with 1 increment by 1),
                           `first_name` varchar(50) NOT NULL,
                           `last_name` varchar(50) NOT NULL,
                           `email` varchar(100) NOT NULL,
                           `birthdate` date NOT NULL,
                           `added` timestamp NOT NULL GENERATED ALWAYS AS (CAST(now() AS TIMESTAMP)),
                           PRIMARY KEY (`id`)
)
USING delta TBLPROPERTIES('delta.feature.allowColumnDefaults' = 'supported',
'delta.columnMapping.mode' = 'name',
'delta.minReaderVersion' = '2',
'delta.minWriterVersion' = '5');

INSERT INTO main.liquibase_harness_test_ds.authors (id, first_name, last_name, email, birthdate)
VALUES ('1','Eileen','Lubowitz','ppaucek@example.org','1991-03-04'),
                             ('2','Tamia','Mayert','shansen@example.org','2016-03-27'),
                             ('3','Cyril','Funk','reynolds.godfrey@example.com','1988-04-21'),
                             ('4','Nicolas','Buckridge','xhoeger@example.net','2017-02-03'),
                             ('5','Jayden','Walter','lillian66@example.com','2010-02-27');

DROP TABLE IF EXISTS main.liquibase_harness_test_ds.posts;

CREATE TABLE main.liquibase_harness_test_ds.posts (
                         `id` BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY(start with 1 increment by 1),
                         `author_id` BIGINT NOT NULL,
                         `title` varchar(255) NOT NULL,
                         `description` varchar(500) NOT NULL,
                         `content` STRING NOT NULL,
                         `inserted_date` DATE,
                         CONSTRAINT author_posts_fk FOREIGN KEY (author_id) REFERENCES main.liquibase_harness_test_ds.authors
)
USING delta TBLPROPERTIES('delta.feature.allowColumnDefaults' = 'supported',
'delta.columnMapping.mode' = 'name',
'delta.minReaderVersion' = '2',
'delta.minWriterVersion' = '5')
;

INSERT INTO main.liquibase_harness_test_ds.posts (id, author_id, title, description, content, inserted_date) VALUES ('1','1','temporibus','voluptatum','Fugit non et doloribus repudiandae.','2015-11-18'),
                           ('2','2','ea','aut','Tempora molestias maiores provident molestiae sint possimus quasi.','1975-06-08'),
                           ('3','3','illum','rerum','Delectus recusandae sit officiis dolor.','1975-02-25'),
                           ('4','4','itaque','deleniti','Magni nam optio id recusandae.','2010-07-28'),
                           ('5','5','ad','similique','Rerum tempore quis ut nesciunt qui excepturi est.','2006-10-09');